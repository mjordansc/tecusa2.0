(()=>{"use strict";var t={20:(t,e,a)=>{a(411);var r=a(609),i=60103;if("function"==typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),o("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,a){var r,o={},c=null,m=null;for(r in void 0!==a&&(c=""+a),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(m=e.ref),e)n.call(e,r)&&!l.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===o[r]&&(o[r]=e[r]);return{$$typeof:i,type:t,key:c,ref:m,props:o,_owner:s.current}}e.jsx=c,e.jsxs=c},848:(t,e,a)=>{t.exports=a(20)},411:t=>{var e=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},a=0;a<10;a++)e["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,i){for(var o,s,n=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))a.call(o,c)&&(n[c]=o[c]);if(e){s=e(o);for(var m=0;m<s.length;m++)r.call(o,s[m])&&(n[s[m]]=o[s[m]])}}return n}},609:t=>{t.exports=window.React}},e={};const a=window.wp.blocks,r=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"iconic-woothumbs/attribute-images","version":"1.0.0","title":"WooThumbs Attribute Images - Iconic","category":"woocommerce","icon":"flag","description":"Attribute Images block","attributes":{"property":{"type":"string"}},"supports":{"html":false,"inserter":false},"textdomain":"iconic-woothumbs","editorScript":"file:./index.js","editorStyle":"file:./index.css"}'),i=window.wc.blockTemplates,o=window.wp.i18n,s=window.wc.productEditor,n=window.lodash,l=window.wp.components,c=window.wp.element,m=window.wc.components,u=window.wp.mediaUtils;function d(t,e,a,r){return"all"===t?{...r,data:{...r.data,[t]:{label:e||r.data[t]?.label||"",terms:[{term:"all",images:[]}]}}}:{...r,data:{...r.data,[t]:{label:e||r.data[t]?.label||"",terms:[...r.data[t]?.terms||[],{term:a||"Any",images:[]}]}}}}var b=function a(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,a),o.exports}(848);function p({attributeName:t,attributeImage:e,setAttributeImagesValue:a,productAttributes:r,atributeImagesData:i,searchQuery:s,attributeImages:c}){const p="all"!==t&&Object.values((0,n.pickBy)({0:"Any",...r[t].terms},(e=>!(0,n.some)(i?.[t].terms,["term",e]))));return!!e.terms?.length&&(0,b.jsxs)("div",{className:"wp-block-iconic-woothumbs-attribute-images__attribute-wrapper",children:[(0,b.jsxs)(l.Flex,{className:"wp-block-iconic-woothumbs-attribute-images__attribute",children:[(0,b.jsx)("span",{className:"wp-block-iconic-woothumbs-attribute-images__attribute-label",children:(0,o.sprintf)((0,o.__)("Attribute: %s","iconic-woothumbs"),e.label)}),"all"!==t&&!!p?.length&&(0,b.jsx)(l.Button,{variant:"secondary",size:"compact",onClick:()=>{p.length<2&&setActionField(""),a(d(t,"",p[0],c))},children:(0,o.sprintf)((0,o.__)("Add %s","iconic-woothumbs"),e.label)})]}),e.terms?.filter((t=>!!(0,n.isEmpty)(s)||t.term.toLowerCase().includes(s.toLowerCase()))).map((i=>(0,b.jsxs)(React.Fragment,{children:[(0,b.jsxs)(l.Flex,{children:["all"!==t&&(0,b.jsxs)(l.SelectControl,{style:{width:"200px"},value:i.term,onChange:e=>{a(function(t,e,a,r){return{...r,data:{...r.data,[a]:{...r.data[a],terms:r.data[a]?.terms?.map((a=>a.term!==e?a:{...a,term:t}))}}}}(e,i.term,t,c))},children:[(0,b.jsx)("option",{value:"Any",disabled:(0,n.some)(e.terms,["term","Any"]),children:(0,o.__)("Any","iconic-woothumbs")}),(0,n.map)(r[t]?.terms,(t=>(0,b.jsx)("option",{value:t,disabled:t!==i.term&&(0,n.some)(e.terms,["term",t]),children:t},t)))]}),(0,b.jsx)("div",{className:"wp-block-iconic-woothumbs-attribute-images__remove-term-button-wrapper",children:(0,b.jsx)(l.Icon,{className:"wp-block-iconic-woothumbs-attribute-images__remove-term-button",onClick:()=>{a(function(t,e,a){return"all"===e?{...a,data:(0,n.omit)(a.data,["all"])}:{...a,data:{...a.data,[e]:{...a.data[e],terms:a.data[e]?.terms?.filter((e=>e.term!==t))}}}}(i.term,t,c))},icon:"trash",style:{fontFamily:"dashicons"}})})]}),(0,b.jsx)("div",{className:"wp-block-iconic-woothumbs-attribute-images__attribute-images "+("all"===t?"wp-block-iconic-woothumbs-attribute-images__attribute-images--all":""),children:(0,b.jsxs)(m.CollapsibleContent,{toggleText:(0,o.sprintf)((0,o._n)("%s image","%s images",i.images?.length,"iconic-woothumbs"),i.images?.length),children:[(0,b.jsx)(l.Flex,{justify:"normal",wrap:!0,children:i.images?.map((e=>(0,b.jsx)("div",{className:"wp-block-iconic-woothumbs-attribute-images__attribute-image",title:(0,o.__)("Remove image","iconic-woothumbs"),children:e.url&&(0,b.jsxs)("div",{className:"wp-block-iconic-woothumbs-attribute-images__term-image-wrap",onClick:()=>{a(function(t,e,a,r){return{...r,data:{...r.data,[a]:{...r.data[a],terms:r.data[a]?.terms?.map((a=>a.term!==e?a:{...a,images:a.images?.filter((e=>t!==e.id))}))}}}}(e.id,i.term,t,c))},children:[(0,b.jsx)(l.Icon,{className:"wp-block-iconic-woothumbs-attribute-images__term-image-remove-button",icon:"remove",style:{fontFamily:"dashicons"},title:(0,o.__)("Remove image","iconic-woothumbs")}),(0,b.jsx)("img",{src:e.url,className:"wp-block-iconic-woothumbs-attribute-images__term-image"})]})},e.id)))}),(0,b.jsx)(u.MediaUpload,{allowedTypes:"image",multiple:!0,onSelect:e=>{const r=e.map((t=>({id:`${t.id}`,url:t.url})));a(function(t,e,a,r){return{...r,data:{...r.data,[a]:{...r.data[a],terms:r.data[a]?.terms?.map((a=>a.term!==e?a:{...a,images:[...a.images,...t]}))}}}}(r,i.term,t,c))},render:({open:t})=>(0,b.jsx)(l.Button,{onClick:t,variant:"secondary",size:"compact",children:(0,o.__)("Add Images","iconic-woothumbs")})})]})})]},t)))]})}(0,a.registerBlockType)(r,{edit:function({attributes:t}){const e=(0,i.useWooBlockProps)(t),{property:a,postType:r}=t,[m,u]=(0,s.__experimentalUseProductEntityProp)(a,{postType:r,fallbackValue:!1}),{productAttributes:w,data:h}=m,[g,_]=(0,c.useState)(""),[f,y]=(0,c.useState)("");return(0,b.jsxs)("div",{...e,children:[!(0,n.isEmpty)(w)&&(0,b.jsxs)(l.Flex,{justify:"end",className:"wp-block-iconic-woothumbs-attribute-images__header",children:[(0,b.jsx)(l.TextControl,{value:f,onChange:y,placeholder:(0,o.__)("Filter attribute terms...","iconic-woothumbs")}),(0,b.jsxs)(l.SelectControl,{value:g,onChange:_,children:[(0,b.jsx)("option",{value:"",disabled:!0,children:(0,o.__)("Add attribute images...","iconic-woothumbs")}),(0,b.jsx)("option",{value:"all",disabled:h?.all,children:(0,o.__)("For all attributes","iconic-woothumbs")}),w&&(0,b.jsx)("optgroup",{label:(0,o.__)("For a specific attribute","iconic-woothumbs"),children:(0,n.map)(w,(t=>(0,b.jsx)("option",{disabled:h[t.value]?.terms.length===Object.keys(t.terms).length+1,value:t.value,children:t.label},t.value)))})]}),(0,b.jsx)(l.Button,{variant:"secondary",disabled:!g,onClick:()=>{if(!g)return;if("all"===g)return u(d("all",(0,o.__)("All Atributes","iconic-woothumbs"),"",m)),void _("");const t=Object.values((0,n.pickBy)({0:"Any",...w[g].terms},(t=>!(0,n.some)(h?.[g]?.terms,["term",t]))));t.length<2&&_(""),u(d(g,w[g]["data-label"],t[0],m))},children:(0,o.__)("Add","iconic-woothumbs")})]}),(0,n.map)(h,((t,e)=>(0,b.jsx)(p,{attributeName:e,attributeImage:t,productAttributes:w,atributeImagesData:h,attributeImages:m,setAttributeImagesValue:u,searchQuery:f})))]})}})})();