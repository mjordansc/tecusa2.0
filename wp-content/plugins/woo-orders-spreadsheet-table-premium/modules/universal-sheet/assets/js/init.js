function vgseColumnKeyToExportKey(e){return vgse_editor_settings.export_keys_mapping&&vgse_editor_settings.export_keys_mapping[e]?vgse_editor_settings.export_keys_mapping[e]:e}function vgse_reset_column_mapping(e){e.find("li.map-columns .map-template:not(.hidden)").toArray().forEach(function(e){var e=jQuery(e),t=e.find("select");t.val(t.data("original_selected_value")),e.removeClass("wpse-hidden")}),e.find("li.map-columns button.wpse-show-columns-again").addClass("wpse-hidden"),e.find("li.map-columns button.next-step").last().removeClass("wpse-hidden"),e.find("li.map-columns .wpse-all-columns-ignored-message").remove()}function vgsePrepareColumnHeaderForMapping(e,t){var o,a=(o=-1<["ID","id","record_id"].indexOf(e)?"ID":e).replace(/[0-9]+/g,"");return vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&vgse_editor_settings.wc_repeatable_columns&&(e=t?vgse_editor_settings.wc_repeatable_columns_english:vgse_editor_settings.wc_repeatable_columns,jQuery.each(e,function(e,t){e.replace(/\%d/g,"").toLowerCase()===a.toLowerCase()&&(o=t)})),o}function vgse_get_import_columns_mapping_status(e){var e=e.find("li.map-columns .map-template:not(.hidden)"),t=!0,o=!0;return e.toArray().forEach(function(e){e=jQuery(e);e.hasClass("wpse-hidden")||(o=!1),""!==e.find("select").val()&&(t=!1)}),{all_columns_are_being_ignored:t,all_columns_are_hidden:o}}function vgse_column_mapping_step_is_valid(e,t){if(e.find(".step.current").hasClass("map-columns")){var o=e.find("li.map-columns .map-template:not(.hidden)"),t=(!!t&&t.parent().hasClass("import-auto-map-notice")&&t.hasClass("next-step")&&vgse_reset_column_mapping(e),jQuery(document.createElement("p")).attr({class:"wpse-all-columns-ignored-message"}).text(vgse_editor_settings.texts.import_all_columns_ignored)),a=e.find("li.map-columns button.wpse-show-columns-again"),n=e.find("li.map-columns button.next-step"),r=0<e.find("li.map-columns .wpse-all-columns-ignored-message").length,i=(a.length<=0&&(a=jQuery(document.createElement("button")).attr({class:"wpse-show-columns-again wpse-hidden button button-primary button-primario"}).text(vgse_editor_settings.texts.import_show_all_columns_rows),n.last().after(a)),vgse_get_import_columns_mapping_status(e));if(i.all_columns_are_being_ignored)return r||o.last().after(t),i.all_columns_are_hidden&&(n.last().addClass("wpse-hidden"),a.removeClass("wpse-hidden")),!1;e.find("li.map-columns .wpse-all-columns-ignored-message").remove()}return!0}jQuery(document).ready(function(){if(!jQuery(".import-csv-modal").length)return!0;jQuery(".import-csv-modal .remodal-confirm").hide();var p=jQuery(".import-csv-form");function n(){var e=p.find(".step.current"),t=p.find(".step.current").prev(".step");e.slideToggle(),e.removeClass("current"),t.show(),t.addClass("current")}p.on("click",".map-columns .wpse-show-columns-again",function(e){e.preventDefault(),vgse_reset_column_mapping(p)}),p.on("click",".map-columns .wpse-ignore-column-cross",function(){jQuery;var e=jQuery(this).parent();e.addClass("wpse-hidden"),e.find("select").val(""),vgse_column_mapping_step_is_valid(p)}),p.find(".import-column-bulk-actions select").on("change",function(e){"unselect"===jQuery(this).val()&&jQuery(".map-columns .map-template select").val("")}),p.find(".toggle-advanced-options").on("change",function(e){jQuery(this).parent().next(".advanced-options").slideToggle()}),p.find(".existing-check-csv-field").on("change",function(e){var t,o=jQuery(this).val();o&&((t=p.find(".map-columns .csv-column-name-value").filter(function(){return jQuery(this).val()===o}).parent().find("select").val())?p.find(".wp-field-requires-ignored-column").hide():(p.find(".wp-field-requires-ignored-column").show(),jQuery(this).val("")),jQuery(this).parent(".field-wrapper").next(".field-wrapper").find("option").filter(function(){return jQuery(this).val()===t||jQuery(this).text()===o||"record_id"===o&&"ID"===jQuery(this).text()}).prop("selected",!0).trigger("change"))}),p.find('[name="writing_type"]').on("change",function(e){jQuery(this).val()&&"all_new"!==jQuery(this).val()?p.find(".field-find-existing-columns").show():p.find(".field-find-existing-columns").hide()}),p.find(".data-input,.step").hide(),p.find(".step").first().show(),p.find(".source").on("change",function(e){var t,o=jQuery(this).val();p.find(".data-input").hide(),p.find(".data-input."+o).length&&p.find(".data-input."+o).show(),p.find(".if-data-input-"+o).length&&p.find(".if-data-input-"+o).show(),"paste"===o&&(p.find(".data-input.paste").show(),window.importHOT&&window.importHOT.destroy(),o={minSpareRows:4,wordWrap:!0,allowInsertRow:!0,columnSorting:!0,colHeaders:!1,width:p.width(),height:300},t=document.getElementById("handsontable-paste"),window.importHOT=new Handsontable(t,o))}),p.on("click",".next-step",function(e){var t,o;e.preventDefault(),vgse_column_mapping_step_is_valid(p,jQuery(this))&&(e=p.find(".step.current"),t=p.find(".step.current").next(".step"),e.slideToggle(),e.removeClass("current"),t.show(),t.addClass("current"),(e=p.find(".step.current")).hasClass("preview-step")&&window.vgseImportData&&window.vgseImportData.success&&(window.importPreviewHOT&&window.importPreviewHOT.destroy(),t={data:window.vgseImportData.data.firstRows,minSpareRows:1,wordWrap:!0,allowInsertRow:!0,columnSorting:!0,colHeaders:window.vgseImportData.data.rowHeaders,width:p.width(),height:170},o=document.getElementById("hot-preview"),window.importPreviewHOT=new Handsontable(o,t),jQuery(".import-csv-modal .remodal-confirm").show(),vgseAllowToClosePageWithoutWarning(!0)),e.hasClass("write-type"))}),p.on("click",".prev-step",function(e){e.preventDefault(),n()}),p.find(".vgse-upload-csv-file").on("click",function(e){e.preventDefault();var t,e=jQuery(this),o=e.parents(".data-input"),a=(loading_ajax(!0),{data:{action:"vgse_upload_file_for_import",data_type:e.data("type"),vgse_plain_mode:"yes",nonce:jQuery("#vgse-wrapper").data("nonce"),separator:o.parents(".step").find(".separator").val(),auto_column_names:o.parents(".step").find(".auto_column_names").prop("checked")?"yes":"",decode_quotes:o.parents(".step").find(".decode-quotes").is(":checked")?"on":"",post_type:jQuery("#post-data").data("post-type")},type:"POST",url:vgse_global_data.ajax_url});"local"===e.data("type")?((t=new FormData).append("action","vgse_upload_file_for_import"),t.append("data_type",e.data("type")),t.append("nonce",jQuery("#vgse-wrapper").data("nonce")),t.append("post_type",jQuery("#post-data").data("post-type")),t.append("separator",o.parents(".step").find(".separator").val()),t.append("auto_column_names",o.parents(".step").find(".auto_column_names").prop("checked")?"yes":""),t.append("decode_quotes",o.parents(".step").find(".decode-quotes").is(":checked")?"on":""),t.append("data",""),t.append("file",document.getElementById("vgse-import-local-file").files[0]),a.processData=!1,a.contentType=!1,a.data=t):"json"===e.data("type")?a.data.data=window.importHOT.getSourceData():a.data.data=o.find(".data").val(),jQuery.ajax(a).always(function(l){var e,t;window.vgseImportData=l,loading_ajax(!1),l.success&&l.data.rowHeaders?(p.find(".existing-check-csv-field").each(function(){jQuery(this).find("option:not(:eq(0))").remove()}),p.find(".import-file").val(l.data.fileName),p.find(".total-rows").val(l.data.totalRows),t=l.data.rowHeaders,p.find(".map-template:not(.hidden)").remove(),p.find(".import-column-bulk-actions").val(""),jQuery.each(t,function(e,t){var o,a,n,r,i,s,d;t&&((o=p.find(".map-template.hidden").clone()).removeClass("hidden"),o.find(".csv-column-name-text").text(t).attr("title",t),o.find(".csv-column-name-example").append(vgseStripHtml(l.data.firstRows[0][t]).substring(0,100)),o.find(".csv-column-name-value").val(t),a={},n={},o.find("select option").each(function(){n[jQuery(this).text().trim().toLowerCase()]=jQuery(this),a[jQuery(this).val().trim().toLowerCase()]=jQuery(this)}),d=vgsePrepareColumnHeaderForMapping(t),e=vgsePrepareColumnHeaderForMapping(l.data.translatedHeaders[e],!0),r=vgse_editor_settings.import_saved_column_mappings||vgse_editor_settings.import_saved_column_mappings[d]||vgse_editor_settings.import_saved_column_mappings[e],i=a[vgse_editor_settings.import_saved_column_mappings[d]]||a[vgse_editor_settings.import_saved_column_mappings[e]],s=null,p.data("columnMapping")&&void 0!==p.data("columnMapping")[d]?a[p.data("columnMapping")[d]]&&(s=a[p.data("columnMapping")[d]]):s=r&&i?i:(vgse_editor_settings.is_taxonomy&&"Full hierarchy"===d&&l.data.firstRows&&""!==l.data.firstRows[0]["Full hierarchy"]&&(e=d="Name"),r=d.trim().toLowerCase(),i=e.trim().toLowerCase(),a[i]||a[r]||n[i]||n[r]||null),s&&(s.prop("selected",!0),(d=s.parents("select")).attr("data-selected",s.val()),!1===/^(meta|downloads|attributes):/.test(s.val()))&&vgseLazySelect(d,"importWPColumns"),p.find(".map-template").last().after(o),s&&(/^(meta|downloads|attributes):/.test(s.val())&&s.parents("select").trigger("change"),s.closest("select").data("original_selected_value",s.val())),p.find(".existing-check-csv-field").append('<option value="'+t+'">'+t+"</option>"))}),e=p.find(".map-template:not(.hidden) select").filter(function(){return!jQuery(this).val()}),1===t.length?p.find(".one-column-detected-tip").show():p.find(".one-column-detected-tip").hide(),e.length?(p.find(".import-column-list-headers, .import-column-bulk-actions, .remember-column-mapping").show(),p.find(".map-template:not(.hidden)").show(),p.find(".import-auto-map-notice").hide(),p.find(".map-columns .button-primario.next-step").show()):(p.find(".import-auto-map-notice").show(),p.find(".import-column-list-headers, .import-column-bulk-actions, .remember-column-mapping").hide(),p.find(".map-columns .button-primario.next-step").hide(),p.find(".import-auto-map-notice .import-map-select-columns").on("click",function(e){e.preventDefault(),p.find(".import-column-list-headers, .import-column-bulk-actions").show(),p.find(".map-template:not(.hidden)").show(),p.find(".map-columns .button-primario.next-step").show()}))):(n(),t=void 0!==l.data.message?l.data.message:"Error",notification({mensaje:"Error",tipo:"error",tiempo:18e4}),o.parents(".step").find(".file-upload-error").remove(),o.parents(".step").find(".advanced-options").before('<div class="alert alert-red file-upload-error">'+t+"</div>"))})}),vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&jQuery("body").on("change",".map-template select",function(){var t,e=jQuery(this).val();e&&/^(meta|downloads|attributes):/.test(e)&&("meta:"===jQuery(this).val()?jQuery(this).find("option:selected").attr("value",jQuery(this).parents(".map-template").find(".csv-column-name-text").text().replace("Meta: ","meta:")):(t=jQuery(this).find("option:selected").attr("value").replace(/[0-9]/g,""),p.find('.map-template select option[value*="'+t+'"]:selected').each(function(e){jQuery(this).attr("value",t+e)})))});var l=jQuery(".import-csv-modal");jQuery(document).on("closed",".import-csv-modal",function(){p.show(),p.find(".step").removeClass("current").hide(),p.find(".step").first().addClass("current").show(),l.find(".import-step").hide(),l.find(".remodal-confirm").hide()}),p.append('<input type="hidden" name="wpse_source_suffix" value="'+(vgse_editor_settings.wpse_source_suffix||"")+'" />'),l.on("submit",function(e){if(l.find('[name="schedule_for_later"]').prop("checked"))return!0;e.preventDefault(),l.find(".import-step").show();var r=l.find(".import-response"),e=(r.empty(),l.find("#be-import-nanobar-container").remove(),r.before('<div id="be-import-nanobar-container"></div>'),{classname:"be-progress-bar",target:document.getElementById("be-import-nanobar-container")}),i=new Nanobar(e),e=(i.go(1),p.hide(),l.find(".remodal-cancel").hide(),l.find(".view-log a").attr("href",""),l.find(".view-log").hide(),parseInt(p.find(".total-rows").val())),t={updated:0,created:0,processed:0},s=0,o=(p.find(".existing-check-wp-field").val()&&p.find(".auto-retry-failed-batches").prop("checked",!0),[vgseFormatDate(),jQuery("#post-data").data("post-type"),vgseGuidGenerator()].join("-")),d=(p.find('input[name="wpse_job_id"]').val(o),parseInt(p.find("input.per-page").val()||vgse_editor_settings.save_posts_per_page)),o=formToObject("import-csv-form",{includeEmptyValuedElements:!0});return window.beImportLoop=beAjaxLoop({totalCalls:Math.ceil(e/d),url:vgse_global_data.ajax_url,dataType:"json",method:"POST",data:{action:"vgse_import_csv",form_data:JSON.stringify(o),post_type:vgse_editor_settings.post_type},onSuccess:function(o,a){var n,e;return o.data.log_url&&l.find(".view-log a").attr("href",o.data.log_url),s=0,o.success?(Array.isArray(a.data)?(n=!1,a.data.forEach(function(e,t){"file_position"===e.name&&(a.data[t].value=o.data.file_position,n=!0)}),n||a.data.push({name:"file_position",value:o.data.file_position})):a.data.file_position=o.data.file_position,t.updated+=o.data.updated,t.created+=o.data.created,t.processed+=o.data.processed,e=o.data.message.replace("{total_updated}",t.updated).replace("{total_created}",t.created),a.totalCalls=Math.ceil(parseInt(o.data.total)/d),r.empty(),r.append(e),r.scrollTop(r[0].scrollHeight),a.current===a.totalCalls||o.data.force_complete?(r.append(vgse_editor_settings.texts.import_finished),r.scrollTop(r[0].scrollHeight),i.go(100),l.find("#be-import-nanobar-container").remove(),l.find(".remodal-cancel").show(),l.find(".view-log a").attr("href")&&l.find(".view-log").show(),l.find(".import-actions").hide(),vgseReloadSpreadsheet(!0),!1):(i.go(a.current/a.totalCalls*100),l.find(".remodal-cancel").hide(),l.find(".view-log").hide(),l.find(".import-actions").show(),!0)):("string"==typeof o.data.row&&(o.data.message+=". Row: "+o.data.row+"<br>"+vgse_editor_settings.texts.import_data_issue_correct_restart),r.append("<p>"+o.data.message+"</p>"),r.scrollTop(r[0].scrollHeight),i.go(100),l.find("#be-import-nanobar-container").remove(),l.find(".remodal-cancel").show(),l.find(".view-log a").attr("href")&&l.find(".view-log").show(),l.find(".import-actions").hide(),!1)},onError:function(e,t,o){return++s<=3&&(!!p.find(".auto-retry-failed-batches").is(":checked")||confirm(vgse_editor_settings.texts.import_failed_retry_server_error))?(window.vgseDontNotifyServerError=!0,o.current--,i.go(o.current/o.totalCalls*100),l.find(".remodal-cancel").hide(),l.find(".view-log").hide(),l.find(".import-actions").show(),!0):(r.append(vgse_editor_settings.texts.import_failed_server_error_tips),r.scrollTop(r[0].scrollHeight),i.go(100),l.find("#be-import-nanobar-container").remove(),l.find(".remodal-cancel").show(),l.find(".view-log a").attr("href")&&l.find(".view-log").show(),l.find(".import-actions").hide(),!1)}}),l.find(".pause-import").data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),!1}),l.find(".pause-import").on("click",function(e){e.preventDefault();e=jQuery(this);"pause"===e.data("action")?(e.data("action","play").addClass("button-primary").removeClass("button-secondary").html('<i class="fa fa-play"></i> Resume'),window.beImportLoop.pause(),l.find(".remodal-cancel").show(),l.find(".remodal-confirm").show()):(e.data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),window.beImportLoop.resume(),l.find(".remodal-cancel").hide(),l.find(".view-log").hide(),l.find(".remodal-confirm").hide())})}),jQuery(document).ready(function(){var p=jQuery(".export-csv-form");if(!p.length)return!0;(p=jQuery(".export-csv-form")).find(".export-actions").hide(),p.find(".select-all").on("click",function(e){e.preventDefault(),p.find(".export-columns option").prop("selected",!0).trigger("change")}),p.find(".select-active").on("click",function(e){e.preventDefault();var t=p.find(".export-columns"),o=[];jQuery.each(vgse_editor_settings.columnsFormat,function(e,t){e=vgseColumnKeyToExportKey(e);o.push(e)}),t.find("option").prop("selected",!1),o.forEach(function(e){t.find("option").filter(function(){return jQuery(this).val()===e}).prop("selected",!0)}),t.trigger("change")}),p.find(".unselect-all").on("click",function(e){e.preventDefault(),p.find(".export-columns option").prop("selected",!1).trigger("change")}),p.on("submit",function(e){if(p.find('[name="schedule_for_later"]').prop("checked"))return!0;window.beExportLoop=null;var a,n,t,r,o,i,s,d,l=vgseGetSelectedRowsCount(p);return"selected"===p.find(".wpse-select-rows-options").val()&&(l=(t=vgseGetSelectedIds()).length)&&(a=beGetRowsFilters(),beAddRowsFilter("post__in="+t.join(","))),vgseGetSelectedRowsCount(p)?(t=((n=p.find(".export-response")).empty(),p.find("#be-export-nanobar-container").remove(),n.before('<div id="be-export-nanobar-container"></div>'),{classname:"be-progress-bar",target:document.getElementById("be-export-nanobar-container")}),o={action:"vgse_load_data",vgse_plain_mode:"yes",posts_per_page:r=vgse_editor_settings.export_page_size,vgse_csv_export:"yes",custom_enabled_columns:p.find(".export-columns").val().join(","),line_items_separate_rows:p.find(".wpse_line_items_separate_rows").prop("checked")||0,target_software:p.find(".excel-compatibility-container select").val(),nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:jQuery("#post-data").data("post-type"),filters:beGetRowsFilters(),wpse_job_id:[vgseFormatDate(),jQuery("#post-data").data("post-type"),vgseGuidGenerator()].join("-"),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""},p.find('[name="save_for_later_name"]').val()&&(o.save_for_later={name:p.find('[name="save_for_later_name"]').val(),columns:o.custom_enabled_columns,target_software:o.target_software,filters:o.filters,post_type:o.post_type},(i=jQuery(".export_csv-container")).find(".toolbar-submenu").length||i.append('<div class="toolbar-submenu"></div>'),s=i.find(".toolbar-submenu").length,i.find(".toolbar-submenu .button:contains("+o.save_for_later.name+")").parent().remove(),i.find(".toolbar-submenu").append('<div class="button-container save_export-container"><button name="save_export'+s+'" class="button" data-start-saved-export>'+o.save_for_later.name+"</button></div>"),i.find(".toolbar-submenu").find(".button").last().data("start-saved-export",o.save_for_later)),jQuery("body").trigger("vgSheetEditor:manualExportFilterDataForExport",o),(d=new Nanobar(t)).go(1),p.find(".remodal-cancel").hide(),p.find(".remodal-confirm").hide(),p.find(".export-actions").show(),p.find(".export-columns").prop("disabled",!0).trigger("change"),window.beExportLoop=beAjaxLoop({totalCalls:Math.ceil(l/r),url:vgse_global_data.ajax_url,dataType:"json",method:"POST",data:o,prepareData:function(e,t){return e.paged=e.page,e},onSuccess:function(e,t){return e.success?(t.totalCalls=Math.ceil(parseInt(e.data.total)/r),n.empty(),n.append(e.data.message),n.scrollTop(n[0].scrollHeight),t.current===t.totalCalls?(e.data.export_file_url&&window.location.href.indexOf("no_redirect=1")<0&&-1<e.data.export_file_url.indexOf(window.location.host)&&(window.location.href=e.data.export_file_url),n.scrollTop(n[0].scrollHeight),d.go(100),p.find("#be-export-nanobar-container").remove(),p.find(".export-actions").hide(),p.find(".remodal-cancel").show(),p.find(".remodal-confirm").show(),p.find(".export-columns").prop("disabled",!1).trigger("change"),void 0!==a&&beAddRowsFilter("post__in="),!1):(d.go(t.current/t.totalCalls*100),p.find(".remodal-cancel").hide(),!0)):(n.append("<p>"+e.data.message+"</p>"),n.scrollTop(n[0].scrollHeight),d.go(100),p.find("#be-export-nanobar-container").remove(),p.find(".remodal-cancel").show(),p.find(".remodal-confirm").show(),p.find(".export-columns").prop("disabled",!1).trigger("change"),!1)},onError:function(e,t,o){if(30<r&&(500<=e.status||"timeout"===t))window.vgseDontNotifyServerError=!0,r=10,o.data.posts_per_page=r,o.current=0;else{if(!confirm(vgse_editor_settings.texts.formula_retry_batch))return n.append(vgse_editor_settings.texts.process_execution_failed),n.scrollTop(n[0].scrollHeight),d.go(100),p.find("#be-export-nanobar-container").remove(),p.find(".remodal-cancel").show(),p.find(".remodal-confirm").show(),p.find(".export-columns").prop("disabled",!1).trigger("change"),void 0!==a&&beAddRowsFilter("post__in="),!1;window.vgseDontNotifyServerError=!0,o.current--,d.go(o.current/o.totalCalls*100)}return p.find(".remodal-cancel").hide(),!0}}),p.find(".pause-export").data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause')):alert(vgse_editor_settings.texts.no_rows_for_export),!1}),p.find(".pause-export").on("click",function(e){e.preventDefault();e=jQuery(this);"pause"===e.data("action")?(e.data("action","play").addClass("button-primary").removeClass("button-secondary").html('<i class="fa fa-play"></i> Resume'),window.beExportLoop.pause(),p.find(".remodal-cancel").show(),p.find(".remodal-confirm").show(),p.find(".export-columns").prop("disabled",!1).trigger("change"),p.find(".export-actions").show()):(e.data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),window.beExportLoop.resume(),p.find(".remodal-cancel").hide(),p.find(".remodal-confirm").hide())}),p.find(".export-columns").on("change",function(){window.beExportLoop&&(window.beExportLoop.pause(),p.find(".export-actions").hide())})}),jQuery(document).ready(function(){var o=jQuery('[data-remodal-id="export-csv-modal"]');jQuery("body").on("click","[data-start-saved-export]",function(e){e.preventDefault();var e=jQuery(this).data("start-saved-export"),t=(o.remodal().open(),o.find(".export-columns"));t.find("option").prop("selected",!1),e.columns.split(",").forEach(function(e){t.find('option[value="'+e+'"]').prop("selected",!0)}),t.trigger("change"),o.find(".excel-compatibility-container select").val(e.target_software||""),jQuery("body").data("be-filters",""),beAddRowsFilter(e.filters),o.find('[name="save_for_later_name"]').val(""),o.find(".export-rows").val("list"),o.find(".vgse-trigger-export").click()}),jQuery(document).on("opened",".export-csv-modal",function(){vgse_editor_settings.disable_automatic_loading_rows&&0===hot.countRows()&&setTimeout(function(){jQuery("#vgse-wrapper button[name=load]").click()},400);var o=jQuery(".export-columns"),a=[],a=(jQuery.each(vgse_editor_settings.columnsFormat,function(e,t){e=vgseColumnKeyToExportKey(e);a.push(e)}),a.filter(function(e,t,o){return o.indexOf(e)==t})),e=o.find("option"),t=[],n=[],e=(e.each(function(){-1<a.indexOf(jQuery(this).val())?t["key"+jQuery(this).val()]=jQuery(this):n.push(jQuery(this))}),o.find("option").remove(),a.forEach(function(e){o.append(t["key"+e])}),n.forEach(function(e){o.append(e)}),o.data("wpse-sort-fixed")||o.select2().on("select2:select",function(t){var e=t.params.data.id;(e="string"==typeof e?[e]:e).forEach(function(e){e=jQuery(t.target).children('[value="'+e+'"]');jQuery(t.target).append(e)}),jQuery(t.target).trigger("change"),o.data("wpse-sort-fixed",1)}),jQuery(".export-csv-modal")),r=vgseGetSelectedIds(),i=e.find('.wpse-select-rows-options option[value="selected"]'),s=e.find('.wpse-select-rows-options option[value="current_search"]');i.text(i.text().replace(/ \(\d+\)/,"")+" ("+r.length+")"),s.text(s.text().replace(/ \(\d+\)/,"")+" ("+window.beFoundRows+")"),e.find(".export-response").empty()})}),jQuery(document).ready(function(){var a=jQuery('[data-remodal-id="export-csv-modal"]');if("undefined"==typeof hot||!a.length)return!0;var e=hot.getSettings().contextMenu;void 0===e.items&&(e.items={}),e.items.wpse_export_column={name:vgse_editor_settings.texts.export_column,hidden:function(){var e;return!(hot.getSelected()&&(e=hot.colToProp(hot.getSelected()[0][1]),a.find(".export-columns").find('option[value="'+e+'"]').length||vgse_editor_settings.export_keys_mapping&&vgse_editor_settings.export_keys_mapping[e]))},callback:function(e,t,o){var r=a.find(".export-columns");r.find("option").toArray().forEach(function(e){jQuery(e).prop("selected",!1)}),t.forEach(function(e){for(var t=(e.start.col>e.end.col?e.end:e.start).col,o=(e.start.col>e.end.col?e.start:e.end).col,a=[],n=t;n<=o;n++)a.push(n);a.forEach(function(e){e=vgseColumnKeyToExportKey(hot.colToProp(e));r.find('option[value="'+e+'"]').prop("selected",!0)})}),a.remodal().open(),r.find('option[value="'+vgseColumnKeyToExportKey(hot.colToProp(1))+'"]').prop("selected",!0),r.trigger("change"),a.find(".export-rows").val("list"),a.find(".vgse-trigger-export").click()}},hot.updateSettings({contextMenu:e})});