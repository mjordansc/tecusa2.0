function vgseGenerateMathFormula(e){return!!e.firstFieldValue&&'=MATH("'+e.firstFieldValue+'")'}function vgseGenerateDecreasePercentageFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ - (($current_value$ * '+parseFloat(e.firstFieldValue)+') / 100)")'}function vgseGenerateIncreasePercentageFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ + (($current_value$ * '+parseFloat(e.firstFieldValue)+') / 100)")'}function vgseGenerateDecreaseFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ - '+e.firstFieldValue+'")'}function vgseGenerateIncreaseFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ + '+e.firstFieldValue+'")'}function vgseGenerateFakeFormula(e){return'=REPLACE(""$current_value$"",""$current_value$"")'}function vgseGenerateSetValueFormula(e){var t;return e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length&&(t="",e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t),!!e.firstFieldValue&&'=REPLACE(""$current_value$"",""'+e.firstFieldValue+'"")'}function vgseGenerateSetRandomValueFormula(e){var t;return e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length&&(t="",e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t),!!e.firstFieldValue&&'=REPLACE(""$current_value$"",""$random_value_start$'+e.firstFieldValue+'$random_value_end$"")'}function vgseGenerateAppendFormula(e){var t,s,i;return e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length&&(t="",e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t),!!e.firstFieldValue&&(i="","post_terms"!==(s=Alpine.$data(document.querySelector('[x-data="bulkEdit"]')).getValueTypeOfFirstSelectedColumn())&&"boton_gallery_multiple"!==s||(i=vgse_editor_settings.taxonomy_terms_separator),'=REPLACE(""$current_value$"",""$current_value$'+(i=e.columnSettings.list_separation_character&&"string"==typeof e.columnSettings.list_separation_character?e.columnSettings.list_separation_character:i)+e.firstFieldValue+'"")')}function vgseGenerateClearValueFormula(e){return'=REPLACE(""$current_value$"","""")'}function vgseGenerateCapitalizeWordsFormula(e){return'=REPLACE(""$current_value$"",""$current_value_capitalize_each_word$"")'}function vgseGenerateExcerptFormula(e){return!!e.firstFieldValue&&'=REPLACE(""$current_value$"",""$current_value_excerpt'+e.firstFieldValue+'$"")'}function vgseGenerateCustomFormula(e){return!!e.firstFieldValue&&(e.firstFieldValue.indexOf("=REPLACE")<0&&e.firstFieldValue.indexOf("=MATH")<0?(alert(vgse_formulas_data.texts.wrong_formula),""):e.firstFieldValue)}function vgseGeneratePHPFormula(e){return!!e.firstFieldValue&&(e.firstFieldValue.match(/^[a-z0-9\_\:]+$/i)?"=PHP:"+e.firstFieldValue+"()":(alert(vgse_formulas_data.texts.wrong_formula),""))}function vgseGeneratePrependFormula(e){var t,s,i;return e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length&&(t="",e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t),!!e.firstFieldValue&&(i="","post_terms"!==(s=Alpine.$data(document.querySelector('[x-data="bulkEdit"]')).getValueTypeOfFirstSelectedColumn())&&"boton_gallery_multiple"!==s||(i=vgse_editor_settings.taxonomy_terms_separator),e.columnSettings.list_separation_character&&"string"==typeof e.columnSettings.list_separation_character&&(i=e.columnSettings.list_separation_character),'=REPLACE(""$current_value$"",""'+e.firstFieldValue+i+'$current_value$"")')}function vgseGenerateReplaceFormula(e){var t=[];return e.actionFields.each(function(){var e=jQuery(this).val()||"";t.push('""'+e+'""')}),!(t.length<2)&&'"""",""""'!==t.join(",")&&"=REPLACE("+t.join(",")+")"}function vgseGenerateMergeFormula(e){var t="";return e.actionFields.each(function(){var e=jQuery(this).val();e&&!t&&(t=e)}),!!t&&'=REPLACE(""$current_value$"",""'+t+'"")'}document.addEventListener("alpine:init",()=>{window.$=jQuery,Alpine.data("bulkEdit",()=>({rowsSelectionType:"",totalSelectedRows:0,columns:[],useSlowerExecution:!1,formula:"",sheetKey:vgse_editor_settings.post_type,nonce:vgse_editor_settings.nonce,bulkEditTypesPlaceholder:vgse_formulas_data.texts.action_select_placeholder,isGeneratingPreview:!1,hasExecutedBulkEditPreviously:!1,previewResult:{before:"",after:"",rowId:0,message:""},emptyPreviewResult:{before:"",after:"",rowId:0,message:""},columnOptionsHtml:"",isProcessPaused:!1,bulkEditTypes:{},builderFields:[],bulkEditType:"",actionDescription:"",builderFieldsData:[],currentActionSettings:{},app:null,executionTookLong:!1,executionStopped:!0,nanobar:null,showNanobar:!1,successMessages:{},executionInProgress:!1,executionResponse:"",extra:{},currentAjaxLoopSettings:{},currentAjaxLoopResults:{},showColumnSelector:!0,showActions:!0,showSlowExecutionField:null,currentColumnIndex:0,init(){this.app=document.querySelector('[x-data="bulkEdit"]'),this.extra=wp.hooks.applyFilters("vgseBulkEditExtra",this.extra,this),wp.hooks.addAction("vgseAddFoundRowsCount","bulkEdit",e=>{window.wpseUpdateBulkEditRowsCount&&(this.totalSelectedRows=e,window.wpseUpdateBulkEditRowsCount=!1)}),this.$watch("rowsSelectionType",e=>{"new_search"===e&&this.goSearch(),this.totalSelectedRows=e?this.getSelectedRowsCount():0}),this.$watch("columns",e=>{this.bulkEditType="",e&&(e=e[0],this.updateBulkEditTypesForColumn(e))}),this.$watch("bulkEditType",e=>{this.builderFields=[];var t=$(".action-fields select.select2");if(t.data("select2"))try{t.select2("destroy"),t.removeClass("wpse-select2-fix")}catch(e){}e&&this.updateBuilderFieldsForAction(this.bulkEditType)}),this.$watch("builderFieldsData",e=>{this.generateFormula()}),jQuery(document).on("closed",'[data-remodal-id="modal-filters"]',()=>{window.vgseBackToBulkEditAfterSearch&&(window.vgseBackToBulkEditAfterSearch=!1,$('[data-remodal-id="modal-bulk-edit"]').remodal().open())}),jQuery(document).on("closed",'[data-remodal-id="modal-bulk-edit"]',()=>{this.executionInProgress=!1,this.executionResponse="",this.showColumnSelector=!0,this.showActions=!0,this.showSlowExecutionField=null,this.previewResult=$.extend({},this.emptyPreviewResult)}),this.fixSelect2();var e=vgseGetPostTypeColumnsOptions({supports_formulas:!0},!1,!1,!1),t="";e.forEach(e=>{t+=e}),this.columnOptionsHtml=t,(e=vgseGetPostTypeColumnsOptions({supports_formulas:!0},!0,!1,!1)).forEach(e=>{vgse_formulas_data.default_actions.merge_columns.input_fields[0].options+=e}),$.each(vgse_formulas_data.columns_actions,(e,t)=>{var s;t="default"===t?vgse_formulas_data.default_actions:(s={},$.each(t,(e,t)=>{t="default"===t?vgse_formulas_data.default_actions[e]:$.extend({},vgse_formulas_data.default_actions[e],t),s[e]=t}),s),vgse_formulas_data.columns_actions[e]=t}),wp.hooks.doAction("vgseBulkEditAfterInit",this)},canShowSlowExecutionField(){return"boolean"==typeof this.showSlowExecutionField?this.showSlowExecutionField:this.columns.length&&this.formula},setToValue(e,t,s){var i;for(s=s.split("."),i=0;i<s.length-1;i++)e=e[$.isNumeric(s[i])?parseInt(s[i]):s[i]];e[s[i]]=t},fixSelect2(){var e=document.querySelectorAll(".remodal-bulk-edit .select2[x-model]:not(.wpse-select2-fix)");Array.from(e).forEach(t=>{t.classList.add("wpse-select2-fix");let s=$(t);var e=t.getAttribute("x-model");let i=e.replace("[",".").replace("]","").replace(".key","."+t.getAttribute("data-builder-field-index"));this.$watch(e,e=>{s.val(e).trigger("change")}),s.on("select2:select select2:unselect",e=>{e=Array.from(e.target.selectedOptions).map(e=>e.value);t.hasAttribute("multiple")||(e=e.length?e[0]:null),"string"==typeof Alpine.$data(this.app).formula&&this.setToValue(Alpine.$data(this.app),e,i)})})},showSpeedTip(){return 10<this.totalSelectedRows&&this.executionTookLong},initNanobar(){var e;this.nanobar||(this.showNanobar=!0,e={classname:"be-progress-bar",target:document.getElementById("be-bulk-edit-nanobar-container")},this.nanobar=new Nanobar(e)),this.nanobar.go(1)},removeNanobar(){this.showNanobar=!1},validateBeforeExecution(e){return!(!this.rowsSelectionType||(this.totalSelectedRows||e?this.formula?beGetModifiedItems().length&&!confirm(vgse_editor_settings.texts.save_changes_before_we_reload):(alert(vgse_formulas_data.texts.formula_required),1):(alert(vgse_editor_settings.texts.no_rows_for_formula),1)))},showBackupAlert(){return"boolean"==typeof this.extra.showBackupAlert?this.extra.showBackupAlert:this.formula},stopExecution(e){this.executionResponse=e,this.executionStopped=!0,this.hasExecutedBulkEditPreviously=!0,this.removeNanobar()},prepareExecutionStart(){this.initNanobar(),this.executionInProgress=!0,this.executionTookLong=!1,this.executionStopped=!1,this.successMessages={},this.executionResponse="",this.isProcessPaused=!1,"selected"===this.rowsSelectionType?e=vgseGetSelectedIds():"previously_selected"===this.rowsSelectionType&&(e=window.wpsePreviouslySelectedIds||[]),void 0!==e&&(t=beGetRowsFilters(),beAddRowsFilter("post__in="+e.join(","))),"send_email"!==this.bulkEditType||this.builderFieldsData[1]||(this.builderFieldsData[1]=wp.editor.getContent("formula-send-email-editor"));var e,t,s=$(".remodal-bulk-edit .multiple-column-selector option:selected"),i=[],s=(s.each(function(){jQuery(this).val()&&i.push({label:jQuery(this).text(),key:jQuery(this).val()})}),this.currentAjaxLoopResults={total:0,processed:0,updated:0},this.totalSelectedRows),o=vgse_editor_settings.save_posts_per_page,l=this.bulkEditType,r=this.builderFieldsData[0],l=(vgse_editor_settings.sheet_uses_real_time_sync||!vgse_editor_settings.is_post_type||"set_value"!==l||"delete"!==r||vgse_editor_settings.delete_attached_images_when_post_delete||(o=vgse_editor_settings.delete_posts_per_page),Math.ceil(s/o)),r=(this.currentColumnIndex=0,{total:s,columns:i,perPage:o,useFixedTotalCalls:!0,fixedTotalCalls:l,selectedIds:e||null,originalFilters:t||null});return r},getTaskArgs(e){return{action:"vgse_bulk_edit_formula_big",total:this.totalSelectedRows,column:e.key,apply_to:"all",formula:this.formula,nonce:this.nonce,post_type:this.sheetKey,filters:vgseGetFiltersJson(),raw_form_data:$(".remodal-bulk-edit form").serialize(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||"",wpse_job_id:vgseGuidGenerator()}},setProgressMessage(e,t){let s=e.message;this.currentAjaxLoopResults.processed+=e.processed,this.currentAjaxLoopResults.updated+=e.updated,this.currentAjaxLoopResults.total||(this.currentAjaxLoopResults.total+=e.total);e=e.force_complete?100:parseInt(this.currentAjaxLoopSettings.current/this.currentAjaxLoopSettings.totalCalls*100);e<1&&(e=1),s=(s=(s=(s=s.replace("{total}",this.currentAjaxLoopResults.total)).replace("{progress_percentage}",e)).replace("{edited}",this.currentAjaxLoopResults.updated)).replace("{column_label}",t[this.currentColumnIndex].label),this.successMessages[this.currentAjaxLoopSettings.data.column]=s,this.nanobar.go(e)},getSuccessMessage(){var e=vgse_editor_settings.texts.formula_execution_complete;return vgse_editor_settings.texts.ask_review&&(e+="<br>"+vgse_editor_settings.texts.ask_review),e},submit(){var i,o,l,r,a,n,u;if(void 0===this.extra.useCustomSubmit||!this.extra.useCustomSubmit())return!!this.validateBeforeExecution()&&({total:i,columns:o,perPage:l,useFixedTotalCalls:r,fixedTotalCalls:a,selectedIds:n,originalFilters:u}=this.prepareExecutionStart(),void(window.bulkEditLoop=beAjaxLoop({totalCalls:Math.ceil(i/l),url:vgse_global_data.ajax_url,dataType:"json",method:"POST",data:this.getTaskArgs(o[this.currentColumnIndex]),onSuccess:(e,t)=>{this.currentAjaxLoopSettings=t;var s=e.data.message;return e.success?(r&&(t.totalCalls=a),this.setProgressMessage(e.data,o),e.data.force_complete||t.current===t.totalCalls?!!this.processNextColumn(o,i,l)||(this.stopExecution(this.getSuccessMessage()),this.setFiltersAfterExecution(u,n),vgseReloadSpreadsheet(),!1):(this.executionTookLong=!0,!(this.executionStopped=!1))):(this.stopExecution(s),!1)},onError:(e,t,s)=>(this.currentAjaxLoopSettings=s,this.handleAjaxError())})));this.extra.submit()},processNextColumn(e,t,s){if(1<e.length&&this.currentColumnIndex<e.length-1)return this.currentColumnIndex++,this.currentAjaxLoopSettings.data.column=e[this.currentColumnIndex].key,this.currentAjaxLoopSettings.current=0,this.currentAjaxLoopSettings.totalCalls=Math.ceil(t/s),this.nanobar.go(1),!(this.currentAjaxLoopResults.processed=this.currentAjaxLoopResults.updated=this.currentAjaxLoopResults.total=0)},handleAjaxError(){return confirm(vgse_editor_settings.texts.formula_retry_batch)?(window.vgseDontNotifyServerError=!0,this.currentAjaxLoopSettings.current--,this.nanobar.go(this.currentAjaxLoopSettings.current/this.currentAjaxLoopSettings.totalCalls*100),!(this.executionStopped=!1)):(this.stopExecution(vgse_editor_settings.texts.formula_execution_failed),!1)},setFiltersAfterExecution(e,t){void 0!==e&&(beAddRowsFilter("post__in="),"selected"===this.bulkEditType)&&t.length&&(window.wpsePreviouslySelectedIds=t),$('.remodal-bulk-edit .wpse-select-rows-options option[value="previously_selected"]').hide(),window.wpsePreviouslySelectedIds&&$('.remodal-bulk-edit .wpse-select-rows-options option[value="previously_selected"]').show()},generatePreview(){this.isGeneratingPreview=!0,this.previewResult=$.extend({},this.emptyPreviewResult),loading_ajax(!0);var e,t=this.nonce,s=this.totalSelectedRows,i=this.formula,o=this.sheetKey,l=vgseGuidGenerator(),r=vgseGetFiltersJson();"selected"===this.rowsSelectionType&&(e=vgseGetSelectedIds()),void 0!==(e="previously_selected"===this.rowsSelectionType?window.wpsePreviouslySelectedIds||[]:e)&&(r="post__in="+e.join(","));try{jQuery.ajax({url:vgse_global_data.ajax_url,dataType:"json",method:"POST",data:{action:"vgse_bulk_edit_formula_big",total:s,column:this.columns[0],formula:i,nonce:t,page:1,post_type:o,wpse_job_id:l,is_preview:!0,filters:r,raw_form_data:jQuery(".remodal-bulk-edit form").serialize(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""},success:e=>{loading_ajax(!1),e.success&&(e=e.data,this.previewResult.rowId=parseInt(e.post_id),this.previewResult.before=e.initial_data&&200<e.initial_data.length?e.initial_data.substring(0,200)+"...":e.initial_data,this.previewResult.after=200<e.data.length?e.data.substring(0,200)+"...":e.data),this.isGeneratingPreview=!1},error:function(e,t,s){loading_ajax(!1),this.isGeneratingPreview=!1}})}catch(e){loading_ajax(!1),this.isGeneratingPreview=!1,this.previewResult.message=vgse_editor_settings.texts.formula_preview_failed}},generateFormula(){var e=this.columns[0],e=vgse_editor_settings.final_spreadsheet_columns_settings[e],t=this.currentActionSettings,s=$(".builder-fields .action-fields").find("input,textarea,select").filter((e,t)=>jQuery(t).attr("name")),t=(t=vgseExecuteFunctionByName(t.jsCallback,window,{actionFields:s,actionSettings:t,firstField:s.first(),firstFieldValue:s.first().val(),columnSettings:e}))||"";this.formula=t,this.isPreviewAllowed()||(this.previewResult=$.extend({},this.emptyPreviewResult))},openMediaLibrary(l,e){loading_ajax(!0);var r=jQuery("body").scrollLeft(),t=jQuery(document).scrollTop(),s=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1);let a=wp.media({frame:"post",state:"insert",multiple:e});a.state("embed").on("select",()=>{var e=a.state(),t=e.get("type"),e=e.props.toJSON();e.url=e.url||"","image"===t&&e.url&&(this.builderFieldsData[l]=e.url)}),a.on("close",()=>{jQuery("body").scrollLeft(r),jQuery(window).scrollTop(t),jQuery("#infinito").prop("checked",s)}),a.on("insert",()=>{jQuery("body").scrollLeft(r);var e=a.state().get("selection"),t=e.length,s=e.models;if(!s.length)return!0;for(var i=[],o=0;o<t;o++)file=s[o].toJSON(),i.push(file.url);this.builderFieldsData[l]=i.join(",")}),a.open(),loading_ajax(!1)},removeFile(e,t){if(!this.builderFieldsData[e])return!0;for(var s=this.builderFieldsData[e].split(","),i=0;i<s.length;i++)if(s[i]==t){s.splice(i,1);break}this.builderFieldsData[e]=s.join(",")},isPreviewAllowed(){var t=!0,e=this.getValueTypeOfFirstSelectedColumn();return!!(e&&this.bulkEditType&&this.formula&&this.totalSelectedRows)&&(e=vgse_formulas_data.columns_actions[e][this.bulkEditType],(t=e.disallow_preview?!1:t)&&this.columns.forEach(e=>{-1<vgse_formulas_data.columns_disallowed_preview.indexOf(e)&&(t=!1)}),t)},getSelectHtmlAttributes(e){e=$.extend(!0,{},e.html_attrs);return void 0!==e["data-extra_ajax_parameters"]&&delete e["data-extra_ajax_parameters"],e},updateBuilderFieldsForAction(e){if(!e)return!0;var t=this.getValueTypeOfFirstSelectedColumn();if(t){var o=vgse_formulas_data.columns_actions[t][e],t=o.input_fields,l=(this.previewResult=$.extend({},this.emptyPreviewResult),this.builderFields=[],this.builderFieldsData=[],o.description&&(o.description=o.description.replace("%target_column%",this.columns[0]),this.actionDescription=o.description),{tag:"",label:"",description:"",html_attrs:{class:"formula-parameter-field",type:"text"}});o.fields_relationship||(o.fields_relationship="AND");let i=0;$.each(t,(e,t)=>{void 0!==(t=$.extend({},l,t)).html_attrs&&void 0!==t.html_attrs.name&&t.html_attrs.name||!t.tag||!/input|textarea|select/i.test(t.tag)||(t.html_attrs.name="formula_data[]");var s=(s=JSON.stringify(t.html_attrs)).replace(/\{column_key\}/g,this.columns[0]);t.html_attrs=JSON.parse(s),0<i&&this.builderFields.push({tag:"span",label:o.fields_relationship,html_attrs:{class:"relationship-"+o.fields_relationship.toLowerCase()+" relationship"}}),this.builderFields.push(t),i++}),this.currentActionSettings=o,setTimeout(()=>{vgseInitSelect2($(".remodal-bulk-edit .action-fields .select2")),$(".remodal-bulk-edit .action-fields").find("input:not(.no-formatted-field),textarea:not(.no-formatted-field)").each((e,t)=>{vgseInputToFormattedColumnField(this.columns[0],jQuery(t).parent(),".formula-parameter-field")})},10)}},initTinyMce(t){wp.editor.initialize("bulkEditField"+t,{tinymce:{wpautop:!0,plugins:"charmap colorpicker compat3x directionality fullscreen hr image lists media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wptextpattern wpview",toolbar1:"bold italic underline strikethrough | bullist numlist | blockquote hr wp_more | alignleft aligncenter alignright | link unlink | fullscreen | wp_adv",toolbar2:"formatselect alignjustify forecolor | pastetext removeformat charmap | outdent indent | undo redo | wp_help",setup:e=>{e.on("change",e=>{this.builderFieldsData[t]=wp.editor.getContent("bulkEditField"+t)})}},quicktags:{buttons:"strong,em,link,ul,li,code"},mediaButtons:!0})},getValueTypeOfFirstSelectedColumn(){var e=this.$refs.columnsSelector;if(e.selectedOptions&&this.columns.length)return e.selectedOptions[0].getAttribute("data-value-type")},updateBulkEditTypesForColumn(o){var t=this.$refs.columnsSelector,s=this.getValueTypeOfFirstSelectedColumn();if(s){let i=vgse_editor_settings.final_spreadsheet_columns_settings[o],e=vgse_formulas_data.columns_actions[s];e||(t.selectedOptions[0].setAttribute("data-value-type","text"),e=vgse_formulas_data.columns_actions.text),this.builderFields=[],this.bulkEditTypes={},$.each(e,(e,t)=>{if(i&&i.supported_formula_types&&i.supported_formula_types.length&&i.supported_formula_types.indexOf(e)<0)return!0;var s=void 0===t.allowed_column_keys||!t.allowed_column_keys||-1<t.allowed_column_keys.indexOf(o);(s=void 0!==t.disallowed_column_keys&&-1<t.disallowed_column_keys.indexOf(o)?!1:s)&&(this.bulkEditTypes[e]=t.label)})}},pauseJob(){this.isProcessPaused=!0,this.executionResponse=vgse_editor_settings.texts.bulk_edit_paused,window.bulkEditLoop.pause()},resumeJob(){this.isProcessPaused=!1,this.executionResponse="",window.bulkEditLoop.resume()},goBackToForm(){this.pauseJob(),this.executionInProgress=!1},goSearch(){window.vgseBackToBulkEditAfterSearch=!0,$('[data-remodal-id="modal-filters"]').remodal().open()},getSelectedRowsCount(){var e=window.beFoundRows;return"selected"===this.rowsSelectionType?e=vgseGetSelectedIds().length:"previously_selected"===this.rowsSelectionType&&(e=(window.wpsePreviouslySelectedIds||[]).length),e}}))}),jQuery(document).ready(function(){jQuery("body").on("mousedown","th .bulk-selector",function(e){jQuery("th .bulk-selector").data("value-before-click",jQuery(this).prop("checked"))}),jQuery("body").on("click","th .bulk-selector",function(e){for(var t=jQuery(this),s=jQuery("th .bulk-selector"),i=!t.data("value-before-click"),o=hot.countRows()-1,l=[],r=0;r<=o;r++)l.push([r,0,i]);hot.setDataAtCell(l),jQuery("th .bulk-selector").prop("checked",i),s.data("value-before-click",i),i&&(window.wpseDontOpenBulkEditOnSelectAll||jQuery('[data-remodal-id="modal-bulk-edit"]').remodal().open(),t=vgse_editor_settings.enable_pagination?"selected":"current_search",Alpine.$data(document.querySelector('[x-data="bulkEdit"]')).rowsSelectionType=t)}),jQuery(document).on("opened",".remodal-bulk-edit",function(){var e=Alpine.$data(document.querySelector('[x-data="bulkEdit"]'));vgseGetSelectedIds().length&&!jQuery("th .bulk-selector").prop("checked")&&(e.rowsSelectionType="selected")})}),jQuery(document).ready(function(){jQuery(".quick-bulk-action").on("click",function(){var t,e=jQuery(this).data("action"),s=jQuery(".remodal-bulk-edit");let i=Alpine.$data(document.querySelector('[x-data="bulkEdit"]'));i.showColumnSelector=e.allow_to_select_column,e.columns&&(t=[],e.columns.forEach(e=>{void 0!==vgse_editor_settings.final_spreadsheet_columns_settings[e]&&t.push(e)}),i.columns=t),setTimeout(()=>{e.type_of_edit&&(i.bulkEditType=e.type_of_edit),e.values&&e.values.length&&setTimeout(()=>{i.builderFieldsData=e.values},100)},100),e.type_of_edit&&e.values&&e.values.length?(i.showActions=!1,s.find("form").attr("novalidate","novalidate")):i.showActions=!0,e.hide_slow_execution_field?(i.showSlowExecutionField=!1,s.find("form").attr("novalidate","novalidate")):i.showSlowExecutionField=null,s.remodal().open()})}),jQuery(document).ready(function(){if("undefined"==typeof hot||!jQuery(".remodal-bulk-edit").length)return!0;var e=hot.getSettings().contextMenu;void 0===e.items&&(e.items={}),e.items.wpse_bulk_edit_column={name:vgse_editor_settings.texts.bulk_edit_column,hidden:function(){var e;return!hot.getSelected()||(e=hot.colToProp(hot.getSelected()[0][1]),(e=vgse_editor_settings.final_spreadsheet_columns_settings[e])&&!e.supports_formulas)},callback:function(e,t,s){jQuery(".remodal-bulk-edit").remodal().open();var i=Alpine.$data(document.querySelector('[x-data="bulkEdit"]')),t=hot.colToProp(t[0].start.col);i.columns=[t]}},hot.updateSettings({contextMenu:e})});